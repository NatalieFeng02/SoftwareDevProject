<nav>
  <h1>LyricSense</h1>
</nav>
{{> header}}


<div class="container mt-5">
  <h2 class="text-center mb-4">Results for '{{searchQuery}}'</h2>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th scope="col" class="album-cover-header"></th> <!-- Empty header for album cover -->
          <th scope="col">Title</th>
          <th scope="col">Artist</th>
          <th scope="col">Album</th>
        </tr>
      </thead>
      <tbody>
        {{#each searchResults}}
        <tr class="clickable-row" data-title="{{title}}" data-artist="{{artist}}" data-album="{{album}}" data-album-cover="{{this.albumCover}}">
          <td class="album-cover-cell">
            <img src="{{this.albumCover}}" alt="{{this.title}}" class="album-cover">
          </td>
          <td><div class="result-button" data-type="title">{{this.title}}</div></td>
          <td><div class="result-button" data-type="artist">{{this.artist}}</div></td>
          <td><div class="result-button" data-type="album">{{this.album}}</div></td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
  
  <nav aria-label="Search results pages" class="mt-4">
    <ul class="pagination justify-content-center" id="pages">
      {{#each pages}}
      
        <li class="page-item{{#if this.isCurrent}} active{{/if}}">
          <a class="page-link" href="?searchQuery={{../searchQuery}}&page={{this.number}}">{{this.number}}</a>
        </li>
      {{/each}}


      {{!-- THIS LOGIC BELOW IS NOT CORRECT, WE NEED MUCH MORE COMPLICATED LOGIC TO ADD ELIPSES --}}
      
      
      {{!-- {{#unless lastPageIsCurrent}}
        <li class="page-item"><span class="page-link">...</span></li>
        <li class="page-item">
          <a class="page-link" href="?searchQuery={{searchQuery}}&page={{totalPages}}">{{totalPages}}</a>
        </li>
      {{/unless}} --}}
      
    </ul>
  </nav>
</div>

{{> footer}}

<!-- Additional CSS for the album cover images -->
<style>
  nav{
    font-family: 'DieNasty', sans-serif;
  }

  #pages {
    font-family: sans-serif;
  }


  .album-cover {
    width: 50px; /* Adjust size as needed */
    height: auto;
    margin-right: 10px;
  }
  .album-cover-header {
    width: 1%; /* Minimize the width of the album cover header */
    white-space: nowrap; /* Ensure the header does not expand */
  }
  .album-cover-cell {
    padding-left: 10px; /* Add some padding to the left of the album cover image */
  }

  .table td {
    vertical-align: middle;
  }

   .clickable {
    cursor: pointer; /* Changes cursor to indicate the item is clickable */
  }
  .result-button {
    background: none;
    border: none;
    text-align: left;
    padding: 0;
    margin: 0;
    color: inherit;
    font: inherit;
    cursor: pointer;
    display: block;
    width: 100%;
  }
  .result-button:hover {
    background-color: #f8f9fa; /* Light color on hover, adjust as needed */
  }
  /* You might want to add :focus styles if you want to keep the button-like interaction */
  .result-button:focus {
    outline: none; /* Removes the default focus outline */
    /* You can add custom focus styles if needed */
  }
</style>

<script>
  console.log("Javascript is working here");
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.clickable-row').forEach(row => {
      row.addEventListener('click', function() {
        // Call handleRowClick directly with the current row context
        handleRowClick(this);
      });
    });
  });

function handleRowClick(row) {
  const title = encodeURIComponent(row.getAttribute('data-title'));
  const artist = encodeURIComponent(row.getAttribute('data-artist'));
  const album = encodeURIComponent(row.getAttribute('data-album'));
  
  // Find the <img> element within the clicked row and get its src attribute
  const albumCoverElement = row.querySelector('.album-cover'); // Use querySelector to find the first element with the class
  const albumCover = albumCoverElement ? encodeURIComponent(albumCoverElement.src) : ''; // Get the src attribute of the img element, and handle case where it might not exist
  
  const loadingUrl = `/loading?redirectUrl=${encodeURIComponent(`/analysis?title=${title}&artist=${artist}&album=${album}&albumCover=${albumCover}`)}`;
  window.location.href = loadingUrl;
}





</script>



{{!-- **************TEST DATA FOR RESULTS*******************

{{> header}}

<div class="container mt-5">
  <h2 class="text-center mb-4">Results for 'Ziggy Stardust'</h2>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th scope="col" class="album-cover-header"></th>
          <th scope="col">Title</th>
          <th scope="col">Artist</th>
          <th scope="col">Album</th>
        </tr>
      </thead>
      <tbody>
        <!-- Mock Data: David Bowie Songs -->
        <tr>
          <td class="album-cover-cell">
            <img src="/img/ZiggyStardust.png" alt="Starman" class="album-cover">
          </td>
          <td>Starman</td>
          <td>David Bowie</td>
          <td>Ziggy Stardust and the Spiders from Mars</td>
        </tr>
        <tr>
          <td class="album-cover-cell">
            <img src="/img/ZiggyStardust.png" alt="Space Oddity" class="album-cover">
          </td>
          <td>Space Oddity</td>
          <td>David Bowie</td>
          <td>Ziggy Stardust and the Spiders from Mars</td>
        </tr>
        <!-- Repeat for additional songs... -->
      </tbody>
    </table>
  </div>
  
  <nav aria-label="Search results pages" class="mt-4">
    <ul class="pagination justify-content-center">
      <!-- Mock Pagination -->
      <li class="page-item active"><a class="page-link" href="?page=1">1</a></li>
      <li class="page-item"><a class="page-link" href="?page=2">2</a></li>
      <li class="page-item"><a class="page-link" href="?page=3">3</a></li>
      <li class="page-item"><span class="page-link">...</span></li>
      <li class="page-item"><a class="page-link" href="?page=7">7</a></li>
    </ul>
  </nav>
</div>

<style>
  .album-cover {
    width: 50px; /* Adjust size as needed */
    height: auto;
    margin-right: 10px;
  }
  .album-cover-header {
    width: 1%; /* Minimize the width of the album cover header */
    white-space: nowrap; /* Ensure the header does not expand */
  }
  .album-cover-cell {
    padding-left: 10px; /* Add some padding to the left of the album cover image */
  }
</style>

{{> footer}}

--}}











